{"id":"636d0392660abf001dcf507e","title":"dd-trace plugin fails to resolve module due to missing `main` entrypoint on `standalone` builds · Issue #40735 · vercel/next.js","image":"https://gyazo.com/186a49e7965593c3236ca424dc6bbe86/raw","created":1668088723,"updated":1668089057,"lines":[{"id":"636d0392660abf001dcf507e","text":"dd-trace plugin fails to resolve module due to missing `main` entrypoint on `standalone` builds · Issue #40735 · vercel/next.js","created":1668088723,"updated":1668088723},{"id":"636d03924ade4d0000ba59de","text":"[dd-trace plugin fails to resolve module due to missing `main` entrypoint on `standalone` builds · Issue #40735 · vercel/next.js https://github.com/vercel/next.js/issues/40735]","created":1668088723,"updated":1668088723},{"id":"636d03924ade4d0000ba59df","text":"[https://gyazo.com/186a49e7965593c3236ca424dc6bbe86]","created":1668088723,"updated":1668088735},{"id":"636d039e4ade4d0000ba59e5","text":"すごいピンポイントの話だが、[next.js] の `output` を `standalone` にして standalone モードでビルドした時に [datadog] のトレーサーである `dd-trace` を `require` すると壊れるという怪現象にブチ当たった","created":1668088735,"updated":1668088874},{"id":"636d04294ade4d0000ba59e6","text":"おもえばエラーが全てを語っているのだが、大変長くあれやこれや探ってようやく `.next/standalone/node_modules/next/package.json` の `main` が整合性とれてないから壊れてるんだということがわかった","created":1668088874,"updated":1668088960},{"id":"636d04a94ade4d0000ba59e8","text":"\tいくつかのモジュールを `require` すると通るんだけど、`next` と `dd-trace` だけ `require` が通らなくて「どゆこと？」となり沼に落ちていった","created":1668089002,"updated":1668089057},{"id":"636d04884ade4d0000ba59e7","text":"[Docker] でビルドした後にこいつを書き換えるスクリプトを挟むと通るようになった","created":1668088969,"updated":1668088999},{"id":"636d03924ade4d0000ba59e0","text":"","created":1668088723,"updated":1668088723},{"id":"636d03924ade4d0000ba59e1","text":"","created":1668088723,"updated":1668088723},{"id":"636d03924ade4d0000ba59e2","text":"#20221110 #1110","created":1668088723,"updated":1668088723},{"id":"636d03924ade4d0000ba59e3","text":"","created":1668088723,"updated":1668088723},{"id":"636d03924ade4d0000ba59e4","text":"","created":1668088723,"updated":1668088723}]}