{"id":"5c2b8f409f8f4c001703e519","title":"うけみちゃんの新バージョンをリリースしました - blog.jgs.me","image":"https://66.media.tumblr.com/tumblr_mbs7midRH31qa2uot.png","created":1350055020,"updated":1571935976,"lines":[{"id":"5c2b92ac4ade4d000054646c","text":"うけみちゃんの新バージョンをリリースしました - blog.jgs.me","created":1350055020,"updated":1546359813},{"id":"5c2b92ac4ade4d000054646d","text":"[https://66.media.tumblr.com/tumblr_mbs7midRH31qa2uot.png]","created":1350055020,"updated":1350055020},{"id":"5c2b92ac4ade4d000054646e","text":"うけみちゃん( [http://twitter.com/ykybot http://twitter.com/ykybot] )がバージョンアップしました。ここまでの日々は長かったです。前回のバージョンアップっぽいバージョンアップは2012/02/09でした。それまでの間に突然死の復旧なんかをしたり( [http://b-jigsaw.tumblr.com/post/26254978590/think-about-cloud http://b-jigsaw.tumblr.com/post/26254978590/think-about-cloud] )、うけみと音声で会話したり( [http://b-jigsaw.tumblr.com/post/23988183295/ukemi-on-siri http://b-jigsaw.tumblr.com/post/23988183295/ukemi-on-siri] )、WindowsPhoneアプリを作ったり( [http://instagram.com/p/L6ipfFxmCq/ http://instagram.com/p/L6ipfFxmCq/] )してました。","created":1350055020,"updated":1350055020},{"id":"5c2b92ac4ade4d000054646f","text":"実は、うけみの1st Anniversaryの2012/06/21に巨大アップデートを仕掛けようとしていたのですが、積りに積もったパスタコードの束をどうしようもなくて断念しました。それからも時々取り組んではいたんですがあまり思うように進んでいませんでした。","created":1350055020,"updated":1350055020},{"id":"5c2b92ac4ade4d0000546470","text":"そんなところに風雲急を告げるのが、おれたちの[あそなす]先生で、[秋吉]でさささっと開発の進め方を示してくださりました。","created":1350055020,"updated":1571935897},{"id":"5c2b92ac4ade4d0000546471","text":"(ここに画像があった)","created":1350055020,"updated":1571935872},{"id":"5c2b92ac4ade4d0000546472","text":"なるほどな！なるほどな！ローカル環境(develop)とステージング環境(staging)とプロダクション環境(production)に分ければいいんだな！と、その日のうちぐらいにstaging環境ののだいたいの準備を整えてしまいました。","created":1350055020,"updated":1350055020},{"id":"5c2b92ac4ade4d0000546473","text":"ついでに気になっていた[jenkins]も導入して、[git]のcommitをフックにテストが走るようになりました。","created":1350055020,"updated":1571935905},{"id":"5c2b92ac4ade4d0000546474","text":"さーて、あとはテスト書くだけだ！わはは！","created":1350055020,"updated":1350055020},{"id":"5c2b92ac4ade4d0000546475","text":"とjasmineでテストを書き始めたはいいものの、結局テストに何を書けばいいかわからなくてそこでまた足踏みしていました。","created":1350055020,"updated":1350055020},{"id":"5c2b92ac4ade4d0000546476","text":"それからまた時は流れて、またまたブレイクスルーしてくださるのはあそなす先生でした！某社インターンシップの最終発表の前日にまた秋吉食べてたら「なんで[coffee]書かないの？」って指摘されて「なんとなく食わず嫌いで・・・」って言ってたところに、1500行ぐらいの[Coffeescript]のソースコード渡されて読んでたら、だんだん「あれ？これ実は便利なんじゃね？」って気分になってきて、最終発表そっちのけでCoffeescriptの環境を整えました。","created":1350055020,"updated":1571935914},{"id":"5c2b92ac4ade4d0000546477","text":"それで、どうせなら自動でjsに変換してほしいなあ…これ、jenkinsでやればいいのかなあ？なんて調べてみると、grunt.jsというモジュールを発見しました。これがまあ素晴らしいモジュールで、予めスクリプトを指定しておくとdeploy時に自動でjsやcssをminifyしてくれたり、自動でテストを走らせてくれたりするんです。さようなら、jenkins。[grunt.js]で、ファイルの変更をフックに自動でjsに変換してくれるように設定して、それからは既存のjsファイルを整理、分割してcoffee化するだけでした。","created":1350055020,"updated":1571935921},{"id":"5c2b92ac4ade4d0000546478","text":"継ぎ足し継ぎ足しでつくられたコードはすごく汚くて、DRYもへったくれもなかったので(とはいえ、1年半ぐらいの前の自分ならこれぐらいでしょうがないなって感じだったけど)[node.js]の流儀に従ったりしながらモジュールに分割していきました。","created":1350055020,"updated":1571935930},{"id":"5c2b92ac4ade4d0000546479","text":"そして、ある程度のところまで完成してローカル環境で動作したら今度はステージング環境で…というような流れでしばらくコーディングしていました。ここの部分、ちゃんとテストを書いてテストがパスされたら自動でステージング環境にデプロイ、みたいなことをしたいのですが、相変わらずテストが書けないので今回は一旦保留ということにしました。","created":1350055020,"updated":1350055020},{"id":"5c2b92ac4ade4d000054647a","text":"こうして、だんだんと美しくなりながら、母のpostを咀嚼しながら成長しています。稼働してから1年と4ヶ月ほどで、ドキュメント数は50万に達しました。","created":1350055020,"updated":1350055020},{"id":"5c2b92ac4ade4d000054647b","text":"今回のアップデートで","created":1350055020,"updated":1350055020},{"id":"5c2b92ac4ade4d000054647c","text":"・ユーザストリーム対応","created":1350055020,"updated":1350055020},{"id":"5c2b92ac4ade4d000054647d","text":"リプライ等をユーザストリームで受け取って返信するようになりました。","created":1350055020,"updated":1350055020},{"id":"5c2b92ac4ade4d000054647e","text":"・自動フォロー","created":1350055020,"updated":1350055020},{"id":"5c2b92ac4ade4d000054647f","text":"自動でフォローをするようになりました。","created":1350055020,"updated":1350055020},{"id":"5c2b92ac4ade4d0000546480","text":"・無差別ふぁぼをやめ、自分のタイムラインのみふぁぼする仕様に変更しました。","created":1350055020,"updated":1350055020},{"id":"5c2b92ac4ade4d0000546481","text":"目に見えやすい機能はこれぐらいです。それから、","created":1350055020,"updated":1350055020},{"id":"5c2b92ac4ade4d0000546482","text":"・自動咀嚼","created":1350055020,"updated":1350055020},{"id":"5c2b92ac4ade4d0000546483","text":"実はいままで、母親のpostを食べる部分は半人力でやっていました。というのも、DBに慣れていなかったのでDBをいじる部分を完全に任せちゃうのは抵抗があったからです。しかし、それも1年強[Mongo]で遊び続けて、死も乗り越えた今はいくらでも復旧できる自信がついたので自動で食べるようになりました。","created":1350055020,"updated":1571935949},{"id":"5c2b92ac4ade4d0000546484","text":"・[cron]の廃止","created":1350055020,"updated":1571935952},{"id":"5c2b92ac4ade4d0000546485","text":"今まで、cronを回して動作させていたのですが、これをやめて全ての機能を1つのプロセスにまとめてそのプロセス内でまとめて一定間隔で動作するようになりました。","created":1350055020,"updated":1350055020},{"id":"5c2b92ac4ade4d0000546486","text":"とまあ、こんなぐらいですかね。まだあるかも。","created":1350055020,"updated":1350055020},{"id":"5c2b92ac4ade4d0000546487","text":"シンプルなアルゴリズムなのですが、先にも書いた通り、現在DBには50万のドキュメントがあってそれを基に生成しているせいかだんだん安定してきたかなあ、と自分では感じています。これから、100万、1000万になったときどうなっているのか楽しみです。","created":1350055020,"updated":1350055020},{"id":"5c2b92ac4ade4d0000546488","text":"1年強かかってしまいましたが、基礎的な部分は整ったのでこれからは生成アルゴリズムの改良をしていきたいと考えています。","created":1350055020,"updated":1350055020},{"id":"5c2b92ac4ade4d0000546489","text":"それから、今日「shigeki.ykybot.com」みたいなAPI叩くと「status.ykybot.com」が変化したりすると面白いよねー、なんて話をしていたのでそのうちできたらいいなあ。","created":1350055020,"updated":1350055020},{"id":"5c2b92ac4ade4d000054648a","text":"最後に、最近の[Twitter]まわりの話を。","created":1350055020,"updated":1571935965},{"id":"5c2b92ac4ade4d000054648b","text":"件の新規約からしばらく経って、署名運動が起きたものの何か変わったわけでもなく(だよね？)Twitterは自爆の道を進んでいるようですが、無責任ながら僕みたいな弱小デベロッパーは関係ないやー、と高を括っていました。でも、そこも危うくて、APIの上限が厳しくなったのか、たまにAPIが弾かれることがあったりして困っています。どうなるんだろう。","created":1350055020,"updated":1350055020},{"id":"5c2b92ac4ade4d000054648c","text":"ただ、年内を目処に全ツイートダウンロードが可能になるそうなので自然言語処理まわりのとき、自分の全ツイートをつかって〜みたいなことが容易にできそうですね。現在APIで取得できない過去のツイートも取得できれば母親の過去ツイートをDBにいれることができるのでドキュメント数が増やせそうです。(母親は嫌がりそうだけど)","created":1350055020,"updated":1350055020},{"id":"5c2b92ac4ade4d000054648d","text":"それでは、我が娘、[うけみ]ちゃんと仲良くしてやってください。","created":1350055020,"updated":1571935976},{"id":"5db1d68c4ade4d0000064c38","text":"","created":1571935884,"updated":1571935884},{"id":"5c2b92ac4ade4d000054648e","text":"October 13th, 2012 12:17am ykybot","created":1350055020,"updated":1350055020},{"id":"5c2b92ac4ade4d000054648f","text":"[* original: http://blog.jgs.me/post/33428949054]","created":1350055020,"updated":1350055020},{"id":"5c2b92ac4ade4d0000546490","text":"#20121013 #1013","created":1350055020,"updated":1571935880},{"id":"5db1d6854ade4d0000064c37","text":"","created":1571935878,"updated":1571935878}]}