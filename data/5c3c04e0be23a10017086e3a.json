{"id":"5c3c04e0be23a10017086e3a","title":"hubotとhipchatでウワサのChatOpsの準備 - dev.jgs.me","image":null,"created":1382367600,"updated":1567291170,"lines":[{"id":"5c3c04e04ade4d0000c9d8a0","text":"hubotとhipchatでウワサのChatOpsの準備 - dev.jgs.me","created":1382367600,"updated":1382367600},{"id":"5c3c04e04ade4d0000c9d8a2","text":"むかし見かけたけど、あまり便利さがわからなかったのでスルーしていた [hubot] が面白そうだったので、ちょっと触ってみることにした。","created":1382367600,"updated":1567291099},{"id":"5c3c04e04ade4d0000c9d8a3","text":"","created":1382367600,"updated":1382367600},{"id":"5c3c04e04ade4d0000c9d8a4","text":"目標は、サービスのデプロイや、通知なんかを一手に管理できる状態。","created":1382367600,"updated":1382367600},{"id":"5c3c04e04ade4d0000c9d8a5","text":"","created":1382367600,"updated":1382367600},{"id":"5c3c04e04ade4d0000c9d8a6","text":"`hubot` のインストールは簡単で `npm` からインストールするだけ。","created":1382367600,"updated":1382367600},{"id":"5c3c04e04ade4d0000c9d8a7","text":"","created":1382367600,"updated":1382367600},{"id":"5c3c04e04ade4d0000c9d8a8","text":"`% npm install -g hubot`","created":1382367600,"updated":1382367600},{"id":"5c3c04e04ade4d0000c9d8a9","text":"","created":1382367600,"updated":1382367600},{"id":"5c3c04e04ade4d0000c9d8aa","text":"インストールしたら","created":1382367600,"updated":1382367600},{"id":"5c3c04e04ade4d0000c9d8ab","text":"","created":1382367600,"updated":1382367600},{"id":"5c3c04e04ade4d0000c9d8ac","text":"`% mkdir YOUR_BOT_NAME`","created":1382367600,"updated":1567291109},{"id":"5c3c04e04ade4d0000c9d8ad","text":"`% hubot --create YOUR_BOT_NAME`","created":1382367600,"updated":1567291118},{"id":"5c3c04e04ade4d0000c9d8ae","text":"","created":1382367600,"updated":1382367600},{"id":"5c3c04e04ade4d0000c9d8af","text":"でテンプレートを展開してくれる。`coffee` がないよ！って言われるときは `% npm install -g coffee-script` してやればOK。","created":1382367600,"updated":1382367600},{"id":"5c3c04e04ade4d0000c9d8b0","text":"","created":1382367600,"updated":1382367600},{"id":"5c3c04e04ade4d0000c9d8b1","text":"初期状態だと `redis-brain` という保存用の `redis` が走るようになっているので `hubot-scripts.json` から `redis-brain.coffee` を削除してから起動してみる。","created":1382367600,"updated":1382367600},{"id":"5c3c04e04ade4d0000c9d8b2","text":"","created":1382367600,"updated":1382367600},{"id":"5c3c04e04ade4d0000c9d8b3","text":"code:_","created":1382367600,"updated":1382367600},{"id":"5c3c04e04ade4d0000c9d8b4","text":" % hubot -n Alfred","created":1382367600,"updated":1382367600},{"id":"5c3c04e04ade4d0000c9d8b5","text":"","created":1382367600,"updated":1382367600},{"id":"5c3c04e04ade4d0000c9d8b6","text":" `-n` で名前を指定できるので適当に指定してやる。シェルで起動したら","created":1382367600,"updated":1382367600},{"id":"5c3c04e04ade4d0000c9d8b7","text":"","created":1382367600,"updated":1382367600},{"id":"5c3c04e04ade4d0000c9d8b8","text":"code:_","created":1382367600,"updated":1382367600},{"id":"5c3c04e04ade4d0000c9d8b9","text":" Alfred> @Alfred ping","created":1382367600,"updated":1382367600},{"id":"5c3c04e04ade4d0000c9d8ba","text":" Alfred> PONG","created":1382367600,"updated":1382367600},{"id":"5c3c04e04ade4d0000c9d8bb","text":"","created":1382367600,"updated":1382367600},{"id":"5c3c04e04ade4d0000c9d8bc","text":"みたいな感じで確認できる。","created":1382367600,"updated":1382367600},{"id":"5c3c04e04ade4d0000c9d8bd","text":"","created":1382367600,"updated":1382367600},{"id":"5c3c04e04ade4d0000c9d8be","text":"うまいことウェブから操作できないかなあ、といろいろ探してみたところ [hiptchat] をインターフェイスにするのがよさげだったので [http://www.hipchat.com http://www.hipchat.com] から適当に登録。チャットルームに[BOT]を追加するのが意外と面倒で、`hipchat` の `Room` の設定ページから `invite url` を取得してきて、`Sign out` してから `invite url` を踏んでBOT用のアカウントを登録する。メアドめんどくさいときには `your_name+botname@gmail.com` みたいな感じで `Gmail` の便利機能を使えばよい。","created":1382367600,"updated":1567291147},{"id":"5c3c04e04ade4d0000c9d8bf","text":"","created":1382367600,"updated":1382367600},{"id":"5c3c04e04ade4d0000c9d8c0","text":"あとは、`hubot` のディレクトリで","created":1382367600,"updated":1382367600},{"id":"5c3c04e04ade4d0000c9d8c1","text":"","created":1382367600,"updated":1382367600},{"id":"5c3c04e04ade4d0000c9d8c2","text":"code:_","created":1382367600,"updated":1382367600},{"id":"5c3c04e04ade4d0000c9d8c3","text":" % npm install hubot-hipchat --save","created":1382367600,"updated":1382367600},{"id":"5c3c04e04ade4d0000c9d8c4","text":"","created":1382367600,"updated":1382367600},{"id":"5c3c04e04ade4d0000c9d8c5","text":"としてやって `adapter` をインストールして環境変数を設定する。面倒なので[シェルスクリプト]を作っておくとよい。","created":1382367600,"updated":1567291156},{"id":"5c3c04e04ade4d0000c9d8c6","text":"","created":1382367600,"updated":1382367600},{"id":"5c3c04e04ade4d0000c9d8c7","text":"code:_","created":1382367600,"updated":1382367600},{"id":"5c3c04e04ade4d0000c9d8c8","text":" export HUBOT_HIPCHAT_TOKEN=\"RoomのAdminのToken\"","created":1382367600,"updated":1382367600},{"id":"5c3c04e04ade4d0000c9d8c9","text":" export HUBOT_HIPCHAT_JID=\"BotのアカウントのJabbr ID\"","created":1382367600,"updated":1382367600},{"id":"5c3c04e04ade4d0000c9d8ca","text":" export HUBOT_HIPCHAT_PASSWORD=\"BotアカウントのPassword\"","created":1382367600,"updated":1382367600},{"id":"5c3c04e04ade4d0000c9d8cb","text":" export HUBOT_HIPCHAT_ROOMS=\"Roomの名前\"","created":1382367600,"updated":1382367600},{"id":"5c3c04e04ade4d0000c9d8cc","text":" ","created":1382367600,"updated":1382367600},{"id":"5c3c04e04ade4d0000c9d8cd","text":" exec bin/hubot \"$@\" -n BOT_NAME -a hipchat","created":1382367600,"updated":1382367600},{"id":"5c3c04e04ade4d0000c9d8ce","text":"","created":1382367600,"updated":1382367600},{"id":"5c3c04e04ade4d0000c9d8cf","text":"みたいな `start.sh` を準備して","created":1382367600,"updated":1382367600},{"id":"5c3c04e04ade4d0000c9d8d0","text":"","created":1382367600,"updated":1382367600},{"id":"5c3c04e04ade4d0000c9d8d1","text":"code:_","created":1382367600,"updated":1382367600},{"id":"5c3c04e04ade4d0000c9d8d2","text":" % sh start.sh","created":1382367600,"updated":1382367600},{"id":"5c3c04e04ade4d0000c9d8d3","text":"","created":1382367600,"updated":1382367600},{"id":"5c3c04e04ade4d0000c9d8d4","text":"としてやれば起動する。あとは `hipchat` 側で `@alfred ping` してやれば `PONG` が返ってくる。","created":1382367600,"updated":1382367600},{"id":"5c3c04e04ade4d0000c9d8d5","text":"","created":1382367600,"updated":1382367600},{"id":"5c3c04e04ade4d0000c9d8d6","text":"ひとまずこれで準備は完了。意外と `hipchat` の設定がダルくて、事前にボット用のアカウントを作成しておくと、それを `Room` に追加する手段がなくて消して `invite url` から作りなおしたらいけた。","created":1382367600,"updated":1382367600},{"id":"5c3c04e04ade4d0000c9d8d7","text":"","created":1382367600,"updated":1382367600},{"id":"5c3c04e04ade4d0000c9d8d8","text":"[* original: http://dev.jgs.me/2013/10/22/hubottohipchatdeuwasafalsechatopsfalsezhun-bei]","created":1382367600,"updated":1382367600},{"id":"5c3c04e04ade4d0000c9d8d9","text":"#20131022 #1022","created":1382367600,"updated":1567291170},{"id":"5d6af71c4ade4d0000d3f53e","text":"","created":1567291167,"updated":1567291167}]}