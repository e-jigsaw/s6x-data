{"id":"640fedd6e7793a001ce7b35d","title":"Picsur ローカルで動かすまで","image":null,"created":1678765527,"updated":1678765531,"lines":[{"id":"640fedd6e7793a001ce7b35d","text":"Picsur ローカルで動かすまで","created":1678765527,"updated":1678765527},{"id":"640fedd64ade4d00005d218a","text":"from [20230311] #0311","created":1678765527,"updated":1678765531},{"id":"640fedd64ade4d00005d218b","text":"[Picsur] ローカルで動かすまで","created":1678765527,"updated":1678765527},{"id":"640fedd64ade4d00005d218c","text":"\t[Docker] でぱっと動いたので、すっと立ち上がるかなとおもって試してみたが案外苦労したのでメモ","created":1678765527,"updated":1678765527},{"id":"640fedd64ade4d00005d218d","text":"\t[Angular] のローカル開発","created":1678765527,"updated":1678765527},{"id":"640fedd64ade4d00005d218e","text":"\t\tちょーーーー久しぶりでわけわかめだった","created":1678765527,"updated":1678765527},{"id":"640fedd64ade4d00005d218f","text":"\t\t`ng build` がビルドで、`--watch` で変更トリガーにリビルドが走る","created":1678765527,"updated":1678765527},{"id":"640fedd64ade4d00005d2190","text":"\t\t\tコードベースがでかいのか、割り当ててるリソースが足りてないのか、そもそもホストのマシンが貧弱なのか、なんなのかわからんけど重い","created":1678765527,"updated":1678765527},{"id":"640fedd64ade4d00005d2191","text":"\t\tbuild とは別に `ng serve` で配信してやる必要がある","created":1678765527,"updated":1678765527},{"id":"640fedd64ade4d00005d2192","text":"\t\t\t`--host` でホストを変更できる","created":1678765527,"updated":1678765527},{"id":"640fedd64ade4d00005d2193","text":"\t\t\t\t[Proxmox] の [VM] で作業してる関係で VM のドメインでアクセスしたいため","created":1678765527,"updated":1678765527},{"id":"640fedd64ade4d00005d2194","text":"\t\tよくわからんけど build が勝手に死んでたり、serve が勝手に死んでたりしててダルい","created":1678765527,"updated":1678765527},{"id":"640fedd64ade4d00005d2195","text":"\tコードの書き換え","created":1678765527,"updated":1678765527},{"id":"640fedd64ade4d00005d2196","text":"\t\t`api.service.ts` で [axios] でリクエストを [API] に送っているが、backend も同じエンドポイントで送る想定になっているらしく、url を API エンドポイントの `<host>:8080` を足してやらないといけなかった","created":1678765527,"updated":1678765527},{"id":"640fedd64ade4d00005d2197","text":"\tそしてどうせそんなことだろうとおもっていたが、[CORS] で弾かれるので、`app.module.ts` の `cors` middleware の origin を `<origin>` から `*` に変えておく","created":1678765527,"updated":1678765527},{"id":"640fedd64ade4d00005d2198","text":"\tひとまずこれで permission という API が取得できてログイン画面まで遷移することができた","created":1678765527,"updated":1678765527},{"id":"640fedd64ade4d00005d2199","text":"\t初期の Admin の pass は admin/picsur で入れる","created":1678765527,"updated":1678765527},{"id":"640fedd64ade4d00005d219a","text":"\t画像の配信も同一オリジンからやる想定になっているっぽいので、変えてやらないといけなそう","created":1678765527,"updated":1678765527},{"id":"640fedd64ade4d00005d219b","text":"\t一応設定の画面に Override Host の設定があるんだが、微妙に override されないとこがぼちぼちあってフラグを渡してやらないといけない感じ","created":1678765527,"updated":1678765527},{"id":"640fedd64ade4d00005d219c","text":"\t\t一方で Override されてしまうと `url` にドメインが入っちゃって axios の `url` に二重にドメインが入っちゃうので、適当に正規表現書いてお茶を濁した","created":1678765527,"updated":1678765527},{"id":"640fedd64ade4d00005d219d","text":"\tとりあえ〜〜〜ず動くとこまではきた","created":1678765527,"updated":1678765527},{"id":"640fedd64ade4d00005d219e","text":"","created":1678765527,"updated":1678765527}]}