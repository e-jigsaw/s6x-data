{"id":"5df5529e2fae2800170f37da","title":"rescrap","image":null,"created":1576358561,"updated":1576359148,"lines":[{"id":"5df5529e2fae2800170f37da","text":"rescrap","created":1576358561,"updated":1576358563},{"id":"5df552a44ade4d0000a63e01","text":"","created":1576358564,"updated":1576358564},{"id":"5df552a44ade4d0000a63e02","text":"code:script.js","created":1576358564,"updated":1576358570},{"id":"5df552ab4ade4d0000a63e05","text":" const projects = new Promise((resolve, reject) => {","created":1576358572,"updated":1576358586},{"id":"5df552b94ade4d0000a63e06","text":"    fetch('https://scrapbox.io/api/projects')","created":1576358586,"updated":1576358586},{"id":"5df552b94ade4d0000a63e07","text":"      .then(response => response.json())","created":1576358586,"updated":1576358586},{"id":"5df552b94ade4d0000a63e08","text":"      .then(json => json.projects)","created":1576358586,"updated":1576358586},{"id":"5df552b94ade4d0000a63e09","text":"      .then(resolve)","created":1576358586,"updated":1576358586},{"id":"5df552b94ade4d0000a63e0a","text":"      .catch(reject)","created":1576358586,"updated":1576358586},{"id":"5df552b94ade4d0000a63e0b","text":"  })","created":1576358586,"updated":1576358586},{"id":"5df552b94ade4d0000a63e0c","text":"  ","created":1576358586,"updated":1576358586},{"id":"5df552b94ade4d0000a63e0d","text":"  const rescrap = project => {","created":1576358586,"updated":1576358586},{"id":"5df552b94ade4d0000a63e0e","text":"    const { title, lines } = scrapbox.Page","created":1576358586,"updated":1576358586},{"id":"5df552b94ade4d0000a63e0f","text":"    const body = lines.reduce((acc, { text }) => `${acc}\\n${text}`, '').trim() + `\\n\\nfrom [/${scrapbox.Project.name}/${title}]\\n`","created":1576358586,"updated":1576358586},{"id":"5df552b94ade4d0000a63e10","text":"    const link = `https://scrapbox.io/${encodeURIComponent(project)}/new?body=${encodeURIComponent(body)}`","created":1576358586,"updated":1576358586},{"id":"5df552b94ade4d0000a63e11","text":"    console.log(body)","created":1576358586,"updated":1576359065},{"id":"5df554914ade4d00004254c4","text":"    window.open(link, '_blank', 'noopener')","created":1576359058,"updated":1576359148},{"id":"5df552b94ade4d0000a63e12","text":"  }","created":1576358586,"updated":1576358586},{"id":"5df552b94ade4d0000a63e13","text":"  ","created":1576358586,"updated":1576358586},{"id":"5df552b94ade4d0000a63e14","text":"  const rescrapProjectFilterInput = document.createElement('input')","created":1576358586,"updated":1576358586},{"id":"5df552b94ade4d0000a63e15","text":"  rescrapProjectFilterInput.type = 'text'","created":1576358586,"updated":1576358586},{"id":"5df552b94ade4d0000a63e16","text":"  rescrapProjectFilterInput.id = 'rescrap-filtering-input'","created":1576358586,"updated":1576358586},{"id":"5df552b94ade4d0000a63e17","text":"  rescrapProjectFilterInput.addEventListener('input', async e => {","created":1576358586,"updated":1576358586},{"id":"5df552b94ade4d0000a63e18","text":"    scrapbox.PageMenu('re-scrap').removeAllItems()","created":1576358586,"updated":1576358586},{"id":"5df552b94ade4d0000a63e19","text":"    const query = rescrapProjectFilterInput.value.toLowerCase()","created":1576358586,"updated":1576358586},{"id":"5df552b94ade4d0000a63e1a","text":"  \tfor (const { name, displayName } of await projects) {","created":1576358586,"updated":1576358586},{"id":"5df552b94ade4d0000a63e1b","text":"      if (!name.toLowerCase().includes(query) && !displayName.toLowerCase().includes(query)) continue","created":1576358586,"updated":1576358586},{"id":"5df552b94ade4d0000a63e1c","text":"      scrapbox.PageMenu('re-scrap').addItem({","created":1576358586,"updated":1576358586},{"id":"5df552b94ade4d0000a63e1d","text":"        title: displayName,","created":1576358586,"updated":1576358586},{"id":"5df552b94ade4d0000a63e1e","text":"        onClick: () => { rescrap(name) }","created":1576358586,"updated":1576358586},{"id":"5df552b94ade4d0000a63e1f","text":"      })","created":1576358586,"updated":1576358586},{"id":"5df552b94ade4d0000a63e20","text":"    }","created":1576358586,"updated":1576358586},{"id":"5df552b94ade4d0000a63e21","text":"  })","created":1576358586,"updated":1576358586},{"id":"5df552b94ade4d0000a63e22","text":"  ","created":1576358586,"updated":1576358586},{"id":"5df552b94ade4d0000a63e23","text":"  scrapbox.PageMenu.addMenu({","created":1576358586,"updated":1576358586},{"id":"5df552b94ade4d0000a63e24","text":"    title: 're-scrap',","created":1576358586,"updated":1576358586},{"id":"5df552b94ade4d0000a63e25","text":"    image: 'https://gyazo.com/024fe39c0328fabb99566c6ad743ee54/raw',","created":1576358586,"updated":1576358586},{"id":"5df552b94ade4d0000a63e26","text":"    onClick: async () => {","created":1576358586,"updated":1576358586},{"id":"5df552b94ade4d0000a63e27","text":"      scrapbox.PageMenu('re-scrap').addItem({ title: 'Now loading...', onClick: () => null })","created":1576358586,"updated":1576358586},{"id":"5df552b94ade4d0000a63e28","text":"      await projects","created":1576358586,"updated":1576358586},{"id":"5df552b94ade4d0000a63e29","text":"      scrapbox.PageMenu('re-scrap').removeAllItems()","created":1576358586,"updated":1576358586},{"id":"5df552b94ade4d0000a63e2a","text":"      for (const { name, displayName } of await projects) {","created":1576358586,"updated":1576358586},{"id":"5df552b94ade4d0000a63e2b","text":"        scrapbox.PageMenu('re-scrap').addItem({","created":1576358586,"updated":1576358586},{"id":"5df552b94ade4d0000a63e2c","text":"          title: displayName,","created":1576358586,"updated":1576358586},{"id":"5df552b94ade4d0000a63e2d","text":"          onClick: () => { rescrap(name) }","created":1576358586,"updated":1576358586},{"id":"5df552b94ade4d0000a63e2e","text":"        })","created":1576358586,"updated":1576358586},{"id":"5df552b94ade4d0000a63e2f","text":"      }","created":1576358586,"updated":1576358586},{"id":"5df552b94ade4d0000a63e30","text":"      const ul = document.querySelector('ul[aria-labelledby=\"re-scrap\"].dropdown-menu')","created":1576358586,"updated":1576358586},{"id":"5df552b94ade4d0000a63e31","text":"      rescrapProjectFilterInput.value = ''","created":1576358586,"updated":1576358586},{"id":"5df552b94ade4d0000a63e32","text":"      ul.prepend(rescrapProjectFilterInput)","created":1576358586,"updated":1576358586},{"id":"5df552b94ade4d0000a63e33","text":"      rescrapProjectFilterInput.focus()","created":1576358586,"updated":1576358586},{"id":"5df552b94ade4d0000a63e34","text":"    }","created":1576358586,"updated":1576358586},{"id":"5df552b94ade4d0000a63e35","text":"  })","created":1576358586,"updated":1576358586},{"id":"5df552a44ade4d0000a63e03","text":"","created":1576358564,"updated":1576358564},{"id":"5df552bc4ade4d0000a63e36","text":"code:style.css","created":1576358588,"updated":1576358595},{"id":"5df552c34ade4d0000a63e39","text":" ul[aria-labelledby=\"re-scrap\"].dropdown-menu>li>a {","created":1576358596,"updated":1576358602},{"id":"5df552ca4ade4d0000a63e3a","text":"\t\twidth: 300px;","created":1576358602,"updated":1576358605},{"id":"5df552ca4ade4d0000a63e3b","text":"     text-overflow: ellipsis;","created":1576358602,"updated":1576358605},{"id":"5df552ca4ade4d0000a63e3c","text":"     display: list-item;","created":1576358602,"updated":1576358605},{"id":"5df552ca4ade4d0000a63e3d","text":"\t}","created":1576358602,"updated":1576358605},{"id":"5df552bc4ade4d0000a63e37","text":"","created":1576358588,"updated":1576358588},{"id":"5df552bc4ade4d0000a63e38","text":"from [/customize/re-scrap]","created":1576358588,"updated":1576358621},{"id":"5df552db4ade4d0000a63e3e","text":"","created":1576358619,"updated":1576358619}]}